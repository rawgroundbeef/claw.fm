---
phase: 04-frontend-player
plan: 04
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - web/src/components/Player/PlayerBar.tsx
  - web/src/components/Player/PlayButton.tsx
  - web/src/components/Player/VolumeControl.tsx
  - web/src/components/Player/NowPlaying.tsx
  - web/src/components/Player/ProgressBar.tsx
  - web/src/components/EmptyState.tsx
autonomous: true

must_haves:
  truths:
    - "Player bar is pinned to bottom of viewport (Spotify-style)"
    - "Play/pause button toggles playback state"
    - "Volume slider adjusts from 0-100% with mute toggle"
    - "Now-playing shows track title, artist wallet/name, and cover art"
    - "Progress bar shows elapsed and remaining time"
    - "Empty state displays when no tracks exist"
  artifacts:
    - path: "web/src/components/Player/PlayerBar.tsx"
      provides: "Fixed bottom bar container for all player controls"
      exports: ["PlayerBar"]
    - path: "web/src/components/Player/PlayButton.tsx"
      provides: "Play/pause toggle button"
      exports: ["PlayButton"]
    - path: "web/src/components/Player/VolumeControl.tsx"
      provides: "Volume slider with mute toggle"
      exports: ["VolumeControl"]
    - path: "web/src/components/Player/NowPlaying.tsx"
      provides: "Track info display with cover art"
      exports: ["NowPlaying"]
    - path: "web/src/components/Player/ProgressBar.tsx"
      provides: "Elapsed/remaining time progress display"
      exports: ["ProgressBar"]
    - path: "web/src/components/EmptyState.tsx"
      provides: "Waiting for first track display"
      exports: ["EmptyState"]
  key_links:
    - from: "web/src/components/Player/PlayerBar.tsx"
      to: "PlayButton, VolumeControl, NowPlaying, ProgressBar"
      via: "Composition -- renders child components"
      pattern: "import.*from.*Play|Volume|NowPlaying|Progress"
---

<objective>
Build all player UI components: the bottom bar, play button, volume control, now-playing display, progress bar, and empty state page.

Purpose: These are the visual layer of the player. They accept props from the audio hooks (plan 02) and render the listening interface. Components are built with prop interfaces so they compile independently of the hooks being ready.

Output: 6 React components covering the complete player UI
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-frontend-player/04-CONTEXT.md
@.planning/phases/04-frontend-player/04-01-SUMMARY.md

@packages/shared/src/index.ts -- NowPlayingTrack type
@web/tailwind.config.js -- brand color 'electric': '#0066FF', Inter font
@web/src/index.css -- Tailwind directives
</context>

<tasks>

<task type="auto">
  <name>Task 1: PlayerBar shell, PlayButton, and VolumeControl</name>
  <files>
    web/src/components/Player/PlayerBar.tsx
    web/src/components/Player/PlayButton.tsx
    web/src/components/Player/VolumeControl.tsx
  </files>
  <action>
Design aesthetic from CONTEXT.md: "Clean & minimal aesthetic -- lots of whitespace, subtle colors, focus on the music." and "Bottom bar player pinned to bottom of viewport (Spotify-style persistent bar)."

**PlayerBar.tsx** - Bottom bar container:

Props:
```typescript
interface PlayerBarProps {
  children: React.ReactNode;
}
```

Implementation:
- Fixed to bottom of viewport: `fixed bottom-0 left-0 right-0`.
- Background: white with subtle top border (`border-t border-gray-100`) and slight shadow (`shadow-sm`). Clean, minimal.
- Height: ~80px (`h-20`). Content centered vertically.
- Internal layout: flex row with three sections: left (now-playing info), center (play button + progress), right (volume).
- z-index high enough to overlay content: `z-50`.
- `children` renders the internal content (PlayerBar is just the shell).
- Add `pb-20` spacer note in a comment so App.tsx knows to add bottom padding.

Actually, better approach: PlayerBar takes specific props instead of children, for clearer composition:

```typescript
interface PlayerBarProps {
  leftContent: React.ReactNode;   // NowPlaying
  centerContent: React.ReactNode; // PlayButton + ProgressBar
  rightContent: React.ReactNode;  // VolumeControl
}
```

Layout: `flex items-center justify-between px-4 gap-4`. Left section: `flex-shrink-0 w-1/4 min-w-0`. Center: `flex-1 flex flex-col items-center gap-1`. Right: `flex-shrink-0 w-1/4 flex justify-end`.

**PlayButton.tsx** - Play/pause toggle:

Props:
```typescript
interface PlayButtonProps {
  isPlaying: boolean;
  isLoading: boolean;
  disabled: boolean;      // true when no track available
  onPlay: () => void;
  onPause: () => void;
}
```

Implementation:
- Circular button (`rounded-full`), ~48px diameter.
- When not playing: show play icon (right-pointing triangle, SVG inline). Background: `bg-black text-white`.
- When playing: show pause icon (two vertical bars, SVG inline). Same styling.
- When loading: show a simple spinner (CSS animation, `animate-spin` on a circle SVG). Same size.
- When disabled: `opacity-50 cursor-not-allowed`.
- `onClick`: calls `onPlay()` or `onPause()` based on `isPlaying` state.
- Hover state: `hover:scale-105 transition-transform` for subtle feedback.
- SVG icons are inline (no icon library dependency). Keep them simple.

**VolumeControl.tsx** - Volume slider + mute toggle:

Props:
```typescript
interface VolumeControlProps {
  volume: number;          // 0-1
  isMuted: boolean;
  onVolumeChange: (volume: number) => void;
  onMuteToggle: () => void;
}
```

Implementation:
- Horizontal flex: mute button icon + range slider.
- Mute button: speaker icon SVG. Three states: full volume (volume > 0.5), low volume (volume > 0), muted (volume === 0 or isMuted). Click toggles mute.
- Range slider: `<input type="range" min="0" max="1" step="0.01">`. Style with Tailwind: `accent-electric` for the slider color, or custom styled range input with `appearance-none` and custom track/thumb via CSS.
- Width: ~120px on desktop. Hidden on small screens (mobile volume uses device controls).
- When muted: slider shows 0 position, speaker icon has line through it.
- `onChange`: calls `onVolumeChange(parseFloat(e.target.value))`.
  </action>
  <verify>
Run `cd /Users/rawgroundbeef/Projects/claw.fm && pnpm --filter claw-fm-web exec tsc --noEmit` -- no type errors. Verify all three files exist with correct exports.
  </verify>
  <done>PlayerBar provides fixed bottom layout. PlayButton shows play/pause/loading states. VolumeControl has slider + mute. All use clean, minimal Tailwind styling with brand color.</done>
</task>

<task type="auto">
  <name>Task 2: NowPlaying display, ProgressBar, and EmptyState</name>
  <files>
    web/src/components/Player/NowPlaying.tsx
    web/src/components/Player/ProgressBar.tsx
    web/src/components/EmptyState.tsx
  </files>
  <action>
**NowPlaying.tsx** - Track info display in player bar:

Props:
```typescript
interface NowPlayingProps {
  track: NowPlayingTrack | null;
  isTransitioning?: boolean;  // For crossfade visual transition
}
```

Implementation:
- Horizontal flex: cover art + text info.
- Cover art: 56x56px (`w-14 h-14`) rounded square (`rounded-lg`). If `track.coverUrl` exists, render `<img>`. If no coverUrl, show a placeholder gradient square (not an identicon render -- that's server-side). Use `bg-gradient-to-br from-gray-200 to-gray-300` as fallback.
- Text: track title in medium weight (`font-medium text-sm text-black truncate`), artist name or truncated wallet below in lighter weight (`text-xs text-gray-500 truncate`). If `track.artistName` exists, show it. Otherwise, show wallet address truncated: `${wallet.slice(0, 6)}...${wallet.slice(-4)}`.
- When `track` is null: show nothing (PlayerBar should hide this section or show minimal state).
- When `isTransitioning`: apply `transition-opacity duration-1000` for smooth info swap during crossfade.
- Import `NowPlayingTrack` from `@claw/shared`.

**ProgressBar.tsx** - Elapsed/remaining time:

Props:
```typescript
interface ProgressBarProps {
  currentTime: number;   // seconds elapsed
  duration: number;      // total seconds
  isPlaying: boolean;
}
```

Implementation:
- Layout: full-width bar with time labels.
- Progress track: thin line (`h-1 rounded-full bg-gray-200`) with filled portion (`bg-electric`).
- Fill width: `(currentTime / duration) * 100` percent. Use inline style for precise width.
- Time labels: left shows elapsed (`formatTime(currentTime)`), right shows remaining (`-formatTime(duration - currentTime)`).
- `formatTime(seconds)`: helper that returns `M:SS` format. `const m = Math.floor(s / 60); const sec = Math.floor(s % 60); return m + ':' + sec.toString().padStart(2, '0');`
- Time text: `text-xs text-gray-400 tabular-nums` (tabular-nums prevents layout shift as numbers change).
- When duration is 0 or NaN: show empty bar with `0:00 / 0:00`.
- Width: spans the full center column of PlayerBar.

**EmptyState.tsx** - "Waiting for first track" page:

From CONTEXT.md: "Empty state (no tracks): 'Waiting for first track' message with teaser about how agents submit."

Props:
```typescript
interface EmptyStateProps {
  className?: string;
}
```

Implementation:
- Centered layout, fills available space above the player bar.
- Heading: "Waiting for the first track" in large text (`text-3xl font-bold text-black`).
- Subtext: "AI agents submit music to play on air. The station starts when the first track arrives." in `text-lg text-gray-400`.
- Below: a small accent line (`w-16 h-1 bg-electric mx-auto mt-6`) matching the current placeholder style.
- Optional: subtle pulsing dot or `animate-pulse` on a small element to indicate the station is alive and waiting.
- Clean, minimal, lots of whitespace. Vertically centered in the main content area.
  </action>
  <verify>
Run `cd /Users/rawgroundbeef/Projects/claw.fm && pnpm --filter claw-fm-web exec tsc --noEmit` -- no type errors. Verify all three files exist. NowPlaying imports NowPlayingTrack from @claw/shared.
  </verify>
  <done>NowPlaying shows track info with cover art and truncated wallet. ProgressBar displays elapsed/remaining with thin progress line. EmptyState shows "Waiting for first track" with clean minimal design. All compile without errors.</done>
</task>

</tasks>

<verification>
- `pnpm --filter claw-fm-web exec tsc --noEmit` passes
- Files exist: all 6 component files under `web/src/components/Player/` and `web/src/components/`
- Components use Tailwind classes matching clean/minimal aesthetic
- NowPlaying handles null track and missing coverUrl gracefully
- ProgressBar formats time as M:SS
- EmptyState has clear messaging for no-tracks state
</verification>

<success_criteria>
Complete player UI component library: fixed bottom bar, play/pause button, volume slider with mute, track info with cover art, progress bar with time, and empty state. All components accept props and compile independently. Ready for App.tsx integration.
</success_criteria>

<output>
After completion, create `.planning/phases/04-frontend-player/04-04-SUMMARY.md`
</output>
